(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{209:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return m}));var r=n(0),a=n.n(r);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=a.a.createContext({}),p=function(e){var t=a.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},h=function(e){var t=p(e.components);return a.a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},b=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),h=p(n),b=r,m=h["".concat(l,".").concat(b)]||h[b]||d[b]||o;return n?a.a.createElement(m,i(i({ref:t},s),{},{components:n})):a.a.createElement(m,i({ref:t},s))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=b;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var s=2;s<o;s++)l[s]=n[s];return a.a.createElement.apply(null,l)}return a.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},210:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return l}));var r=n(16),a=n(211);function o(){var e=Object(r.default)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,n=void 0===t?"/":t,o=e.url;return{withBaseUrl:function(e,t){return function(e,t,n,r){var o=void 0===r?{}:r,l=o.forcePrependBaseUrl,i=void 0!==l&&l,c=o.absolute,s=void 0!==c&&c;if(!n)return n;if(n.startsWith("#"))return n;if(Object(a.b)(n))return n;if(i)return t+n;var p=n.startsWith(t)?n:t+n.replace(/^\//,"");return s?e+p:p}(o,n,e,t)}}}function l(e,t){return void 0===t&&(t={}),(0,o().withBaseUrl)(e,t)}},211:function(e,t,n){"use strict";function r(e){return!0===/^(\w*:|\/\/)/.test(e)}function a(e){return void 0!==e&&!r(e)}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},95:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return c})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return h}));var r=n(3),a=n(8),o=(n(0),n(209)),l=n(210),i={id:"Controllers",title:"Controllers",hide_title:!0,sidebar_label:"Controllers"},c={unversionedId:"Controllers",id:"Controllers",isDocsHomePage:!1,title:"Controllers",description:"Controllers",source:"@site/docs/Controllers.md",sourceDirName:".",slug:"/Controllers",permalink:"/docs/Controllers",version:"current",sidebar_label:"Controllers",frontMatter:{id:"Controllers",title:"Controllers",hide_title:!0,sidebar_label:"Controllers"},sidebar:"docs",previous:{title:"Importing plugins",permalink:"/docs/plugins/ImportPlugins"},next:{title:"Extensions",permalink:"/docs/extensions/Extensions"}},s=[{value:"Controllers",id:"controllers",children:[]},{value:"Creating a controller",id:"creating-a-controller",children:[{value:"Creating a controller type",id:"creating-a-controller-type",children:[]},{value:"Implementing a controller",id:"implementing-a-controller",children:[]},{value:"Extending existing dataset",id:"extending-existing-dataset",children:[]},{value:"Extending existing chart",id:"extending-existing-chart",children:[]}]},{value:"A simple example",id:"a-simple-example",children:[]}],p={toc:s};function h(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"controllers"},"Controllers"),Object(o.b)("p",null,"Controllers are able to extend existing chart types or creating new one implementing a specific interface. Leveraging on ",Object(o.b)("a",{parentName:"p",href:"http://www.chartjs.org/"},"Chart.JS")," implementation, ",Object(o.b)("strong",{parentName:"p"},"Charba")," provides the features to extend a controller."),Object(o.b)("img",{src:Object(l.a)("/img/controller.png")}),Object(o.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(o.b)("div",{parentName:"div",className:"admonition-heading"},Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",{parentName:"h5",className:"admonition-icon"},Object(o.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(o.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"limitations")),Object(o.b)("div",{parentName:"div",className:"admonition-content"},Object(o.b)("p",{parentName:"div"},Object(o.b)("a",{parentName:"p",href:"https://www.chartjs.org/docs/latest/developers/charts.html"},"Chart.JS controller")," provides as set of hooks to create an own controller but you should implement all internal structure which is not fully documented and depends on each implementation.",Object(o.b)("br",null),"\nFor this reason, ",Object(o.b)("strong",{parentName:"p"},"Charba")," provides the interfaces to create controllers ",Object(o.b)("strong",{parentName:"p"},"ONLY")," extending existing chart types."))),Object(o.b)("h2",{id:"creating-a-controller"},"Creating a controller"),Object(o.b)("p",null,"To create own chart type, you need to perform some specific and mandatory steps:"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"create a ",Object(o.b)("a",{parentName:"li",href:"https://www.pepstock.org/Charba/4.0/org/pepstock/charba/client/controllers/ControllerType.html"},"controller type")),Object(o.b)("li",{parentName:"ol"},"implement the ",Object(o.b)("a",{parentName:"li",href:"https://www.pepstock.org/Charba/4.0/org/pepstock/charba/client/Controller.html"},"controller")," interface where all hooks are defined"),Object(o.b)("li",{parentName:"ol"},"extend the ",Object(o.b)("a",{parentName:"li",href:"https://www.pepstock.org/Charba/4.0/org/pepstock/charba/client/data/Dataset.html"},"dataset")," class of the original chart type"),Object(o.b)("li",{parentName:"ol"},"extend the ",Object(o.b)("a",{parentName:"li",href:"https://www.pepstock.org/Charba/4.0/org/pepstock/charba/client/IsChart.html"},"chart")," class of the original chart type")),Object(o.b)("h3",{id:"creating-a-controller-type"},"Creating a controller type"),Object(o.b)("p",null,"Controllers must define a unique id in order to be configurable."),Object(o.b)("p",null,"This id should follow the name convention  (otherwise an ",Object(o.b)("a",{parentName:"p",href:"https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html"},"illegal argument")," exception will be thrown):"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"can not start with a dot or an underscore"),Object(o.b)("li",{parentName:"ul"},"can not contain any non-URL-safe characters")),Object(o.b)("p",null,"The ",Object(o.b)("a",{parentName:"p",href:"https://www.pepstock.org/Charba/4.0/org/pepstock/charba/client/controllers/ControllerType.html"},"controller type")," is an entity which must be implemented for every controller you want to implement. A controller type implements ",Object(o.b)("a",{parentName:"p",href:"https://www.pepstock.org/Charba/4.0/org/pepstock/charba/client/Type.html"},"Type")," interface like all other chart types available out-of-the-box. "),Object(o.b)("p",null,"Here are the way how to create a controller type:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-java"},'// creates a chart extending the existing chart LINE\nControllerType myLine = new ControllerType("myline", ChartType.LINE, new ControllerProvider(){\n\n    @Override\n    public Controller provide(ControllerType controllerType){\n        // creates an instance of my controller\n        return myController;\n    }\n\n});\n')),Object(o.b)("p",null,"The controller type constructor is getting a ",Object(o.b)("a",{parentName:"p",href:"https://www.pepstock.org/Charba/4.0/org/pepstock/charba/client/controllers/ControllerProvider.html"},"controller provider")," instance as argument in order to provide the controller during the registration."),Object(o.b)("p",null,"The controller is usually automatically registered in ",Object(o.b)("a",{parentName:"p",href:"http://www.chartjs.org/"},"Chart.JS")," when used. Anyway the controller type object is providing the method to ",Object(o.b)("strong",{parentName:"p"},"register")," the controller programmatically in ",Object(o.b)("a",{parentName:"p",href:"http://www.chartjs.org/"},"Chart.JS"),":"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-java"},"// registers the controller in CHART.JS\nmyControllerType.register();\n")),Object(o.b)("p",null,"You can also be notified when and if the registration of the controller ended correctly. This is done by the implementation of ",Object(o.b)("a",{parentName:"p",href:"https://www.pepstock.org/Charba/4.0/org/pepstock/charba/client/controllers/ControllerRegistrationHandler.html"},"ControllerRegistrationHandler")," interface to set during the controller type creation."),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-java"},'// creates a chart extending the existing chart LINE\nControllerType myLine = new ControllerType("myline", ChartType.LINE, myControllerProvider,\n    \n    new ControllerRegistrationHandler {\n        /**\n         * Invoked before the controller will be register to CHART.JS.\n         * \n         * @param controllerType the controller type which is registering\n         */\n        @Override\n        public void onBeforeRegister(ControllerType controllerType) {\n            // invoked before registration \n        }\n    \n        /**\n         * Invoked after the controller is registered to CHART.JS.\n         * \n         * @param controllerType the controller type which is registering\n         * @param registered true if the controller has been registered otherwise false\n         */\n        @Override \n        public void onAfterRegister(ControllerType controllerType, boolean registered) {\n            // invoked after registration \n            // with the status, if was registered or not.\n        }\n    }\n});\n')),Object(o.b)("h3",{id:"implementing-a-controller"},"Implementing a controller"),Object(o.b)("p",null,"A controller must implement the ",Object(o.b)("a",{parentName:"p",href:"https://www.pepstock.org/Charba/4.0/org/pepstock/charba/client/Controller.html"},"Controller")," interface which is containing all hooks which will be invoked during the whole chart life cycle:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-java"},"/**\n * Controller must define a unique id in order to be configurable.\n * Returns the controller id.\n * \n * @return the controller id.\n */\nControllerType getType();\n\n/**\n * Initializes the controller.\n * \n * @param context context of controller\n * @param chart chart instance\n */\nvoid initialize(ControllerContext context, IsChart chart);\n\n/**\n * Create elements for each piece of data in the dataset. \n * Store elements in an array on the dataset.\n * \n * @param context context of controller\n * @param chart chart instance\n */\nvoid addElements(ControllerContext context, IsChart chart);\n\n/**\n * Draw the representation of the dataset.\n * \n * @param context context of controller\n * @param chart chart instance\n */\nvoid draw(ControllerContext context, IsChart chart);\n\n/**\n * Remove hover styling from the given element.\n * \n * @param context context of controller\n * @param chart chart instance\n * @param element element to be removed.\n * @param datasetIndex dataset index\n * @param index data index\n */\nvoid removeHoverStyle(ControllerContext context, IsChart chart, ControllerDatasetElement element, int datasetIndex, int index);\n\n/**\n * Add hover styling to the given element.\n * \n * @param context context of controller\n * @param chart chart instance\n * @param element element to be set.\n * @param datasetIndex dataset index\n * @param index data index\n */\nvoid setHoverStyle(ControllerContext context, IsChart chart, ControllerDatasetElement element, int datasetIndex, int index);\n\n/**\n * Update the elements in response to new data.\n * \n * @param context context of controller\n * @param chart chart instance\n * @param mode update mode, \n *        core calls this method using any of 'active', 'hide', 'reset', 'resize', 'show' or undefined\n */\nvoid update(ControllerContext context, IsChart chart, IsTransitionKey mode);\n\n/**\n * Ensures that the dataset represented by this controller is linked to a scale.\n * Overridden to helpers.noop in the polar area and doughnut controllers as these\n * chart types using a single scale.\n * \n * @param context context of controller\n * @param chart chart instance\n */\nvoid linkScales(ControllerContext context, IsChart chart);\n\n/**\n * Called by the main chart controller when an update is triggered.\n * The default implementation handles the number of data points changing and creating\n * elements appropriately.\n * \n * @param context context of controller\n * @param chart chart instance\n * @param resetNewElements true if the new elements must be reset\n */\nvoid buildOrUpdateElements(ControllerContext context, IsChart chart, boolean resetNewElements);\n}\n")),Object(o.b)("p",null,"The easy way to implement a controller is to extends the ",Object(o.b)("a",{parentName:"p",href:"https://www.pepstock.org/Charba/4.0/org/pepstock/charba/client/controllers/AbstractController.html"},"AbstractController")," class and implement ",Object(o.b)("inlineCode",{parentName:"p"},"getType")," which returns the new chart type to register."),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-java"},'public class MyHorizontalBarController extends AbstractController {\n\n    public static final ControllerType TYPE = new ControllerType("myHorizontalBar", ChartType.BAR, (controllerType) -> new MyHorizontalBarController()); \n\n    @Override\n    public ControllerType getType(){\n        return TYPE;\n    }\n\n}\n')),Object(o.b)("h3",{id:"extending-existing-dataset"},"Extending existing dataset"),Object(o.b)("p",null,"To use new controller in ",Object(o.b)("strong",{parentName:"p"},"Charba"),", you need to implement a dataset object extending the dataset class of your original chart type of the controller."),Object(o.b)("p",null,"This is mandatory because ",Object(o.b)("a",{parentName:"p",href:"http://www.chartjs.org/"},"Chart.JS")," needs to manage the different types of datasets."),Object(o.b)("p",null,"See the following example:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-java"},"// extends the horizontal bar dataset\npublic final class MyHorizontalBarDataset extends HorizontalBarDataset {\n\n    // extends the constructor of the horizontal bar dataset\n    public MyHorizontalBarDataset(){\n        super(MyHorizontalBarController.TYPE, Dataset.DEFAULT_HIDDEN);\n    }\n\n}\n")),Object(o.b)("h3",{id:"extending-existing-chart"},"Extending existing chart"),Object(o.b)("p",null,"To use new controller in ",Object(o.b)("strong",{parentName:"p"},"Charba"),", you need to implement a chart object extending the chart class of your original chart type of the controller."),Object(o.b)("p",null,"See the following example:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-java"},"// extends the horizontal bar chart\npublic class MyHorizontalBarChart extends HorizontalBarChart{\n\n    public MyHorizontalBarChart(){\n        super(MyHorizontalBarController.TYPE);\n    }\n\n    @Override\n    public MyHorizontalBarDataset newDataset(){\n        return new MyHorizontalBarDataset();\n    }\n    \n    @Override\n    public MyHorizontalBarDataset newDataset(boolean hidden){\n        return new MyHorizontalBarDataset();\n    }\n\n}\n")),Object(o.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(o.b)("div",{parentName:"div",className:"admonition-heading"},Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",{parentName:"h5",className:"admonition-icon"},Object(o.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(o.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"limitations")),Object(o.b)("div",{parentName:"div",className:"admonition-content"},Object(o.b)("p",{parentName:"div"},"You can not set new properties for the controller options in the global or chart type default, only at chart instance."))),Object(o.b)("h2",{id:"a-simple-example"},"A simple example"),Object(o.b)("p",null,"The usage of a controller is to extend an existing chart and change the behavior of it."),Object(o.b)("p",null,"The controller is implementing the behavior but you should extend the current chart (for instance line) extending line chart. "),Object(o.b)("img",{src:Object(l.a)("/img/controllerSample.png")}),Object(o.b)("p",null,"Here is an example."),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-java"},'// -----------------------------------------\n// Creates the chart class of "myLine" chart\n// -----------------------------------------\n// extends the line chart\npublic class MyLineChart extends LineChart {\n\n    // -----------------------------------------\n    // Creates the "myLine" controller type\n    // -----------------------------------------\n    public static final ControllerType TYPE = new ControllerType("myLine", ChartType.LINE, \n        new ControllerProvider(){\n        \n            @Override\n            public Controller provide(ControllerType controllerType){\n                // -----------------------------------------\n                // Creates the "myLine" controller \n                // -----------------------------------------\n                return new AbstractController(){\n    \n                    @Override\n                    public ControllerType getType(){\n                        return MyLineChart.TYPE;\n                    }\n    \n                    @Override\n                    public void draw(ControllerContext jsThis, IsChart chart){\n                        super.draw(jsThis, chart);\n    \n                        DatasetItem item = chart.getDatasetItem(jsThis.getIndex());\n                        \n                        List<DatasetElement> elements = item.getElements();\n                        for (DatasetElement elem : elements){\n                            Context2dItem ctx = chart.getCanvas().getContext2d();\n                            ctx.save();\n                            ctx.setStrokeColor(elem.getOptions().getBorderColorAsString());\n                            ctx.setLineWidth(1D);\n                            ctx.strokeRect(elem.getX() - 10, elem.getY() - 10, 20, 20);\n                            ctx.restore();\n                        }\n                    }\n                };\n            }\n        }\n    );\n\n    public MyLineChart(){\n        super(TYPE);\n    }\n\n    @Override\n    public MyLineDataset newDataset(){\n        return newDataset(false);\n    }\n\n    @Override\n    public MyLineDataset newDataset(boolean hidden){\n        return new MyLineDataset();\n    }\n}\n// -----------------------------------------\n// Creates the dataset class of "myLine" chart\n// -----------------------------------------\npublic final class MyLineDataset extends LineDataset {\n\n    public MyLineDataset(){\n        super(MyLineChart.TYPE, Dataset.DEFAULT_HIDDEN);\n    }\n\n}\n// -----------------------------------------\n// Registers "myLine" controller\n// -----------------------------------------\nMyLineChart.TYPE.register();\n// -----------------------------------------\n// Creates "myLine" chart \n// -----------------------------------------\n// creates the chart\nMyLineChart chart = new MyLineChart();\n// creates the dataset\nMyLineDataset dataset = chart.newDataset();\ndataset.setLabel("dataset 1");\n...\nchart.getData().setDatasets(dataset);\n// add to DOM by Elemental 2\nDomGlobal.document.body.appendChild(chart.getChartElement().as());\n')))}h.isMDXComponent=!0}}]);